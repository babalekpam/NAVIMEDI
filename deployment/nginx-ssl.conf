# Nginx SSL/TLS Configuration for NaviMED
# Fixes: Lucky 13 (CVE-2013-0169) and Obsoleted CBC Ciphers
# Place this in your Nginx server block

# SSL Protocol Configuration - CRITICAL for vulnerability fixes
ssl_protocols TLSv1.2 TLSv1.3;

# Strong Cipher Suites - Disable CBC, Enable GCM
ssl_ciphers ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256;

# Honor cipher order preference
ssl_prefer_server_ciphers on;

# SSL session configuration
ssl_session_cache shared:SSL:50m;
ssl_session_timeout 1d;
ssl_session_tickets off;

# OCSP Stapling
ssl_stapling on;
ssl_stapling_verify on;

# Security headers
add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;
add_header X-Frame-Options DENY always;
add_header X-Content-Type-Options nosniff always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# Disable compression to prevent BREACH
gzip off;

# Perfect Forward Secrecy - Generate with: openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048
ssl_dhparam /etc/ssl/certs/dhparam.pem;