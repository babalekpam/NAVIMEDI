Promotion failed
Your deployment attempt had the following errors:
Application exiting with exit code 0 in server/storage.ts
Health checks are failing for endpoint / on port 80
Application cannot respond to health checks due to early termination
Agent suggestions
async getPatientsWithPrescriptionsForPharmacy(pharmacyTenantId: string, search?: string): Promise<Patient[]> {
    // First implementation
  }

  // ... other code ...

  async getPatientsWithPrescriptionsForPharmacy(pharmacyTenantId: string): Promise<Patient[]> {
    // Second implementation
  }
async getPatientsWithPrescriptionsForPharmacy(pharmacyTenantId: string, search?: string): Promise<Patient[]> {
    // Single implementation with optional search parameter
    const query = db
      .selectDistinct({
        id: patients.id,
        tenantId: patients.tenantId,
        firstName: patients.firstName,
        lastName: patients.lastName,
        dateOfBirth: patients.dateOfBirth,
        gender: patients.gender,
        phone: patients.phone,
        email: patients.email,
        address: patients.address,
        mrn: patients.mrn,
        emergencyContact: patients.emergencyContact,
        allergies: patients.allergies,
        medications: patients.medications,
        isActive: patients.isActive,
        createdAt: patients.createdAt,
        updatedAt: patients.updatedAt
      })
      .from(patients)
      .innerJoin(prescriptions, eq(prescriptions.patientId, patients.id))
      .where(
        and(
          eq(prescriptions.pharmacyTenantId, pharmacyTenantId),
          eq(patients.isActive, true)
        )
      );

    if (search) {
      return await query.where(
        and(
          eq(prescriptions.pharmacyTenantId, pharmacyTenantId),
          eq(patients.isActive, true),
          sql`(LOWER(${patients.firstName}) LIKE LOWER('%' || ${search} || '%') OR 
               LOWER(${patients.lastName}) LIKE LOWER('%' || ${search} || '%') OR 
               ${patients.mrn} LIKE '%' || ${search} || '%')`
        )
      ).orderBy(desc(patients.createdAt));
    }

    return await query.orderBy(desc(patients.createdAt));
  }
// Remove all duplicate method definitions
// Keep only one implementation of each method:
// - getPrescriptionsByTenant
// - getLabOrdersForLaboratory  
// - getPatientCheckIn
// - generatePrescriptionReport
// - generateInventoryReport
export const storage = new DatabaseStorage();
export const storage = new DatabaseStorage();

// Add global error handler to prevent crashes
process.on('uncaughtException', (error) => {
  console.error('Uncaught Exception:', error);
  // Don't exit, just log the error
});

process.on('unhandledRejection', (reason, promise) => {
  console.error('Unhandled Rejection at:', promise, 'reason:', reason);
  // Don't exit, just log the error
});
// Missing health check endpoint or keep-alive mechanism
// Add a simple health check endpoint or ensure main process doesn't exit
// The application should continue running after initialization
// Make sure no synchronous code is causing early exit
// Application may be exiting after completing initialization
// Ensure the server stays running by:
// 1. Starting HTTP server properly
// 2. Not calling process.exit()
// 3. Keeping event loop active
// 4. Handling async operations without terminating